<!DOCTYPE html>
<html>
    <head>
        <title>Experience Board - Map</title>
        <link href="bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
        <link rel="stylesheet" type="text/css" href="css/common.css"/>
        <link rel="stylesheet" type="text/css" href="css/header.css"/>
        <link rel="stylesheet" type="text/css" href="css/maps.css"/>
        <link rel="stylesheet" type="text/css" href="css/exp_board.css"/>
    </head>
    <body>
        <div id="global-container">
            <div class="topbar"></div>
            <div id="header" class="row-fluid">
                <div id="header-wrapper" class="span8 offset2">
                    <div id="logo-container" class="span2"><img src="img/Logo2_162x68.png" alt="Hitupp Logo"></div>
                    <div id="nav-tab" class="span3">
                        <div class="row-fluid no-space">
                            <div id="discover" class="span6">
                                <span class="nav-label">Discover</span>
                            </div>
                            <div id="groups" class="span6">
                                <span class="nav-label">Groups</span>
                            </div>
                        </div>
                    </div>
                    <div id="search-tab" class="span3 offset1 activated" >
                        <div id="search-bar" class="input-prepend">
                            <span class="add-on"><i class="icon-search"></i></span>
                            <input id="search-tool" type="search" placeholder="search experiences or add a friend">
                        </div>
                    </div>
                    <div id="personal" class="span3">
                        <div class="row-fluid">
                            <div id="notif" class="span3 offset3">
                                <img src="img/Bell_41x44.png">
                                <span class="notif-counter">10</span>
                            </div>
                            <div id="avatar-container" class="span4">
                                <div class="hype">72</div>
                                <img id="avatar" src="img/Marcus_44x44.png" alt="Avatar Image">
                            </div>
                            <div class="dropdown" class="span1">
                                <a id="arrow-button" class="dropdown-toggle" data-toggle="dropdown" href='#'>
                                    <img src="img/arrowdown_20x20.png">
                                </a>
                                <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                    <li><a tabindex="-1" href="#">Profile</a></li>
                                    <li><a tabindex="-1" href="#">Settings</a></li>
                                    <li class="divider"></li>
                                    <li><a tabindex="-1" href="{% url 'backend.account.process_logout' %}">Log Out</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="banner" class="row-fluid">
                <div id="title-bar" class="span12">
                    <div id="title-nav" class="span8 offset2">Today / Tomorrow / This Week / Future</div>
                </div>
            </div>
            <div class="row-fluid spacer"></div>
            <div id="map-container" class="row-fluid">
                <div id="map-canvas" class="span8 offset2"></div>
            </div>
        </div>
        <script src="http://code.jquery.com/jquery.js"></script>
        <script src="bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript" 
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBnKcyEfm91RkQjpgO2vboWAqNEUHKQE9Y&sensor=true"></script>
        <script src = "js/infobox.js"></script>
        <script>
        function initialize() {
            var myLatlng = new google.maps.LatLng(43.6492528,-79.394839);
            var mapOptions = {
                zoom: 18,
                center: myLatlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            }
            // create the map based on mapOptions
            var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

            // add a custom marker
            var image = "img/marker.png";
            var marker = new google.maps.Marker({
                 map: map,
                 draggable: false,
                 position: myLatlng,
                 visible: true,
                 icon: image
            });
            
            // create the infoBox
            $('body').append("<div id = \"info\" class=\"info-window\"><div id=\"triangle-left\"></div><div class=\"cover\"></div>" +
                "<div class=\"loc-name\"><b>Aesop Rock</b> at Rivoli</div>" + 
                "<div class=\"desc\">10 PM | $20</div>"+
                "<div class=\"info-toolbar\"><img src=\"img/friends.png\" alt=\"People joining\"><img src=\"img/heart.png\" alt=\"Like this\"><img src=\"img/tweet.png\" alt=\"Tweet this\"></div><div class=\"divider\"></div></div>");

            // hide the div so it doesn't show on page
            $("#info").hide();

            // take contents of div and create into infoBox
            boxText = $("#info").html();         
            var myOptions = {
                content: boxText,
                disableAutoPan: false,
                maxWidth: 0,
                pixelOffset: new google.maps.Size(30, -50),
                zIndex: null,
                boxClass: "info-window",
                boxStyle: { 
                    background: "#222",
                    opacity: 1,
                    width: "auto",
                    color: "#eee",
                },
                closeBoxMargin: "10px 2px 2px 2px",
                closeBoxURL: "", // remove the close button on infoBox
                infoBoxClearance: new google.maps.Size(1, 1),
                isHidden: false,
                pane: "floatPane",
                enableEventPropagation: false,
            };

            // add infoBox on map
            var ib = new InfoBox(myOptions);
            ib.open(map, marker);

            // make sure that infoBox pops up and hides when marker is clicked
            google.maps.event.addListener(marker, 'click', function() {
                var visible = ib.getVisible();
                if (visible){
                    ib.setVisible(false);
                }
                else{
                    ib.setVisible(true);
                }
                
            });
        }
        google.maps.event.addDomListener(window, 'load', initialize);
        </script>
    </body>
    </html>
